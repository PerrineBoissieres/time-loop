{"version":3,"sources":["webpack:///webpack/bootstrap 1ed9eb50c21839f3abd8","webpack:///./src/index.js","webpack:///./src/timer.js"],"names":[],"mappings":"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","file":"time-loop.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\texports: {},\n \t\t\tid: moduleId,\n \t\t\tloaded: false\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.loaded = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(0);\n\n\n\n/** WEBPACK FOOTER **\n ** webpack/bootstrap 1ed9eb50c21839f3abd8\n **/","import Timer from './timer';\n\nlet reg;\nlet currentTime;\nlet fpsCurrentTime;\nlet ev;\nlet i;\nlet prom;\n\nfunction escapeRegExp(str) {\n  return str.replace(/[\\-\\[\\]\\/\\{\\}\\(\\)\\*\\+\\?\\.\\\\\\^\\$\\|]/g, '\\\\$&');\n}\nfunction checkNamespace(timer, namespace) {\n  reg = new RegExp('^' + escapeRegExp(namespace));\n\n  if (reg.test(timer.namespace)) return true;\n\n  return false;\n}\nfunction orderByPriority(ev1, ev2) {\n  return ev2.options.priority - ev1.options.priority;\n}\n\nexport default class TimeLoop {\n  get time() { return Date.now(); }\n\n  constructor() {\n    this.timers = [];\n    this.elapsedTime = 0;\n    this.lastTime = 0;\n    this.paused = true;\n    this.started = false;\n    this.sortable = false;\n    this.autoSort = true;\n    this.defaultNamespace = 'all';\n\n    this.fps = 0;\n    this.fpsLastTime = 0;\n    this.frameCount = 0;\n\n    this.proxyStep = this.step.bind(this);\n\n    // If the browser supports the visibilityChange API, we bind the event\n    // to stop and re-start the loop automatically\n    if (typeof document.hidden !== 'undefined') {\n      document.addEventListener('visibilitychange', () => {\n        if (document.hidden) this.pause();\n        else this.start();\n      }, false);\n    }\n  }\n\n  /**\n   * @method step\n   * Updates all registered timers\n   */\n  step() {\n    if (this.paused) return;\n\n    if (this.autoSort && this.sortable) {\n      this.sort();\n      this.sortable = false;\n    }\n\n    currentTime = fpsCurrentTime = this.time;\n    this.elapsedTime = currentTime - this.lastTime;\n    this.lastTime = currentTime;\n    this.frameCount++;\n\n    if (fpsCurrentTime - 1000 > this.fpsLastTime) {\n      this.fps = this.frameCount;\n      this.frameCount = 0;\n      this.fpsLastTime = fpsCurrentTime;\n    }\n\n    this.timers.map((e) => {\n      if (!e.paused && !e.ended) e.update(this.elapsedTime);\n    });\n\n    window.requestAnimationFrame(this.proxyStep);\n  }\n\n  /**\n   * @method start\n   * Starts the loop if not already started\n   */\n  start() {\n    if (!this.paused) return; // If already started, we quit\n\n    this.lastTime = this.time;\n    this.fpsLastTime = this.time;\n    this.elapsedTime = 0;\n    this.paused = false;\n    this.frameCount = 0;\n\n    if (!this.started) {\n      this.started = true;\n      window.requestAnimationFrame(this.proxyStep);\n    }\n  }\n\n  /**\n   * @method pause\n   * Pauses the loop\n   * @return {TimeLoop} chainable\n   */\n  pause() {\n    this.paused = true;\n    return this;\n  }\n\n  /**\n   * @method resume\n   * Alias for start method\n   * @return {TimeLoop} chainable\n   */\n  resume() {\n    this.start();\n    return this;\n  }\n\n  /**\n   * @method sort\n   * Sorts timers by priority\n   * @return {TimeLoop} chainable\n   */\n  sort() {\n    this.timers.sort(orderByPriority);\n    return this;\n  }\n\n  /**\n   * @method createPool\n   * Creates a given number of empty timers\n   * @param {Number} The number of timers to create\n   * @return {TimeLoop} chainable\n   */\n  createPool(nb) {\n    if (this.timers.length) {\n      throw new Error('Timers have already been created, cannot pre-allocate.');\n    }\n\n    this.timers = new Array(nb);\n\n    for (i = 0; i < nb; i++) {\n      ev = new Timer();\n      ev.ended = true;\n      this.timers[i] = ev;\n    }\n\n    return this;\n  }\n\n  /**\n   * @method createTimer\n   * Creates a new timer, from pool if available\n   * @param {function} callback function to execute\n   * @param {Object} parameters\n   * @param {Object} context for callback execution\n   * @return {Timer} newly created timer\n   */\n  createTimer(cb, options, ctx) {\n    ev = this.getFromPool();\n\n    if (options.namespace) options.namespace = this.defaultNamespace + '.' + options.namespace;\n    else options.namespace = this.defaultNamespace;\n\n    if (ev) {\n      ev.callback = cb;\n      ev.context = ctx || window;\n      ev.ended = false;\n      ev.paused = false;\n      return ev.options(options);\n    }\n\n    ev = new Timer(cb, options, ctx);\n    this.timers.push(ev);\n\n    this.sortable = true;\n\n    return ev;\n  }\n\n  /**\n   * @method getFromPool\n   * Retrieves an ended event from the pool, returns false if none is found\n   * @return {Timer|bool}\n   */\n  getFromPool() {\n    for (i = 0; i < this.timers.length; i++) {\n      ev = this.timers[i];\n      if (ev.ended) return ev;\n    }\n\n    return false;\n  }\n\n  /**\n   * @method namespace\n   * Retrieves timers under given namespace, can execute an action on all of them\n   * @param {String} namespace\n   * @param {String} optional action name (start, pause, end)\n   * @return {Array} array of timers\n   */\n  namespace(namespace, action) {\n    const match = [];\n\n    this.timers.map((e) => {\n      if (!e.ended && checkNamespace(e, namespace)) {\n        if (action && action === 'start') e.paused = false;\n        else if (action && action === 'pause') e.paused = true;\n        else if (action && action === 'end') e.ended = true;\n\n        match.push(e);\n      }\n    });\n\n    return match;\n  }\n\n  /**\n   * @function wait\n   * Creates a timeout and returns a promise\n   * @param {Number} The time to wait before resolving\n   * @return {Promise}\n   */\n  wait(time) {\n    prom = new Promise((resolve) => {\n      this.createTimer(() => resolve(), {\n        type: 'timeout',\n        time,\n      });\n    });\n\n    return prom;\n  }\n\n  /**\n   * @function repeat\n   * Creates an interval\n   * @param {function} The callback function\n   * @param {Number} The time to wait between calls\n   * @return {Timer}\n   */\n  repeat(callback, time = 0) {\n    return this.createTimer({\n      type: 'interval',\n      time,\n    }, callback, this);\n  }\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/index.js\n **/","export default class Timer {\n\n  get defaultOptions() {\n    return {\n      type: 'timeout',\n      time: 0,\n      priority: 1,\n      namespace: '',\n    };\n  }\n\n  /**\n   * @constructor\n   * @param {function} cb The callback to be delayed or repeated\n   * @param {Object} options A list of options\n   * @param {Object} ctx The context of the callback's execution\n   */\n  constructor(cb, options, ctx) {\n    this.settings = extendOptions(this.defaultOptions, options);\n    this.paused = false;\n    this.ended = false;\n    this.callback = cb || undefined;\n    this.context = ctx || window;\n    this.elapsedTime = 0;\n  }\n\n  /**\n   * @method options\n   * Changes the options of an existing Timer\n   * @param {Object} A list of options\n   * @param {bool} false if you don't want to reset all current options\n   * @return {Timer} chainable\n   */\n  options(options, reset = true) {\n    if (!reset) this.settings = extendOptions(this.settings, options);\n    else this.settings = extendOptions(this.defaultOptions, options);\n    return this;\n  }\n\n  /**\n   * @method update\n   * Adds the elapsed time since last call\n   * @param {Number} Number of ms passed\n   */\n  update(ms) {\n    if (this.paused || this.ended) return;\n\n    this.elapsedTime += ms;\n    if (this.elapsedTime >= this.settings.time) {\n      this.callback.call(this.context);\n      this.elapsedTime = 0;\n      if (this.settings.type === 'timeout') this.ended = true;\n    }\n  }\n\n  /**\n   * @method pause\n   * Pauses the event\n   * @return {Timer} chainable\n   */\n  pause() {\n    this.paused = true;\n    return this;\n  }\n\n  /**\n   * @method resume\n   * Resumes the event\n   * @return {Timer} chainable\n   */\n  resume() {\n    this.paused = false;\n    return this;\n  }\n\n  /**\n   * @method reset\n   * Resets internal elapsed time to 0\n   * @return {Timer} chainable\n   */\n  reset() {\n    this.elapsedTime = 0;\n    return this;\n  }\n\n  /**\n   * @method end\n   * Stops the event\n   * @return {Timer} chainable\n   */\n  end() {\n    this.ended = true;\n    return this;\n  }\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/timer.js\n **/"],"sourceRoot":""}